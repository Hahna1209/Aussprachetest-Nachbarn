<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>German Aussprache Training - Nachbarn</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #f4e4bc 0%, #e8d5a6 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 30px;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .header {
            background: linear-gradient(135deg, #d4942a 0%, #c8861f 100%);
            color: white;
            text-align: center;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .header h1 {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #d4942a 0%, #c8861f 100%);
            color: white;
            text-align: center;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            transition: transform 0.2s ease;
        }

        .stat-card:hover {
            transform: translateY(-2px);
        }

        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .stat-label {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .game-area {
            background: rgba(255, 255, 255, 0.8);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .sentence-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .sentence-number {
            background: linear-gradient(135deg, #d4942a 0%, #c8861f 100%);
            color: white;
            padding: 15px 25px;
            border-radius: 25px;
            font-size: 1.2em;
            font-weight: bold;
        }

        .timer {
            background: #2c3e50;
            color: white;
            padding: 15px 25px;
            border-radius: 25px;
            font-size: 1.2em;
            font-family: 'Courier New', monospace;
        }

        .sentence-display {
            background: rgba(255, 255, 255, 0.9);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: inset 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .german-sentence {
            font-size: 1.4em;
            margin-bottom: 20px;
            line-height: 1.6;
            font-weight: 500;
            text-align: justify;
        }

        .phonetic {
            font-size: 1.1em;
            color: #666;
            font-style: italic;
            margin-bottom: 20px;
            line-height: 1.5;
            text-align: justify;
        }

        .translation {
            font-size: 1.1em;
            color: #777;
            line-height: 1.5;
            text-align: justify;
        }

        .word {
            display: inline;
            margin: 1px;
            padding: 1px 2px;
            border-radius: 3px;
            transition: all 0.3s ease;
        }

        .word.correct {
            background-color: #d4edda;
            color: #155724;
        }

        .word.incorrect {
            background-color: #f8d7da;
            color: #721c24;
        }

        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .btn {
            padding: 15px 20px;
            border: none;
            border-radius: 12px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #d4942a 0%, #c8861f 100%);
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background: linear-gradient(135deg, #c8861f 0%, #b8771a 100%);
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #95a5a6 0%, #7f8c8d 100%);
            color: white;
        }

        .btn-secondary:hover:not(:disabled) {
            background: linear-gradient(135deg, #7f8c8d 0%, #6c7b7d 100%);
            transform: translateY(-2px);
        }

        .btn-accent {
            background: linear-gradient(135deg, #8e44ad 0%, #7d3c98 100%);
            color: white;
        }

        .btn-accent:hover:not(:disabled) {
            background: linear-gradient(135deg, #7d3c98 0%, #6c3483 100%);
            transform: translateY(-2px);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .recording {
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .feedback {
            background: rgba(255, 255, 255, 0.9);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            margin-top: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .feedback.excellent {
            border-left: 5px solid #28a745;
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
        }

        .feedback.good {
            border-left: 5px solid #ffc107;
            background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
        }

        .feedback.needs-improvement {
            border-left: 5px solid #dc3545;
            background: linear-gradient(135deg, #f8d7da 0%, #f1aeb5 100%);
        }

        .progress-bar {
            background: #ecf0f1;
            height: 8px;
            border-radius: 4px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress-fill {
            background: linear-gradient(90deg, #d4942a 0%, #c8861f 100%);
            height: 100%;
            width: 0%;
            transition: width 0.5s ease;
        }

        .accuracy-display {
            font-size: 1.5em;
            font-weight: bold;
            color: #2c3e50;
            margin: 10px 0;
        }

        .phonetic-toggle {
            margin-bottom: 15px;
        }

        .difficulty-indicator {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9em;
            display: inline-block;
            margin-bottom: 15px;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2em;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .controls {
                grid-template-columns: 1fr;
            }
            
            .sentence-info {
                flex-direction: column;
                gap: 15px;
            }

            .german-sentence {
                font-size: 1.2em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üè† German Aussprache Training - Nachbarn</h1>
            <p>Verbessern Sie Ihre deutsche Aussprache mit authentischen Nachbarn-Geschichten</p>
        </div>

        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number" id="level">B1-B2</div>
                <div class="stat-label">Level</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="total-sentences">12</div>
                <div class="stat-label">S√§tze</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="accuracy">0%</div>
                <div class="stat-label">Genauigkeit</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="best-score">0%</div>
                <div class="stat-label">Bester Wert</div>
            </div>
        </div>

        <div class="game-area">
            <div class="sentence-info">
                <div class="sentence-number">
                    Satz <span id="current-sentence">1</span> von <span id="total">12</span>
                </div>
                <div class="timer" id="timer">00:00</div>
            </div>

            <div class="sentence-display">
                <div class="difficulty-indicator" id="difficulty">üî• Mittelschwer</div>
                
                <div class="german-sentence" id="german-text">
                    <span class="word">Ich</span> <span class="word">wohne</span> <span class="word">seit</span> <span class="word">drei</span> <span class="word">Jahren</span> <span class="word">in</span> <span class="word">einem</span> <span class="word">Mehrfamilienhaus</span> <span class="word">in</span> <span class="word">Berlin.</span>
                </div>
                
                <div class="phonetic" id="phonetic-text">
                    […™√ß ÀàvoÀên…ô za…™t d Åa…™ ÀàjaÀê Å…ôn …™n Ààa…™n…ôm ÀàmeÀê…êÃØfaÀåmiÀêli…ônÀåha äs …™n b…õ ÅÀàliÀên]
                </div>
                
                <div class="translation" id="translation-text">
                    T√¥i s·ªëng ƒë∆∞·ª£c ba nƒÉm r·ªìi trong m·ªôt cƒÉn nh√† nhi·ªÅu gia ƒë√¨nh ·ªü Berlin.
                </div>
            </div>

            <div class="controls">
                <button class="btn btn-primary" id="listen-btn">
                    üîä H√∂ren
                </button>
                <button class="btn btn-primary" id="record-btn">
                    üé§ Aufnehmen
                </button>
                <button class="btn btn-secondary" id="stop-btn" disabled>
                    ‚èπÔ∏è Stopp
                </button>
                <button class="btn btn-secondary" id="next-btn" disabled>
                    ‚û°Ô∏è N√§chster Satz
                </button>
            </div>

            <div class="controls">
                <button class="btn btn-accent" id="show-phonetic-btn">
                    üìù Lautschrift verbergen
                </button>
                <button class="btn btn-accent" id="repeat-btn">
                    üîÑ Wiederholen
                </button>
            </div>

            <div class="progress-bar">
                <div class="progress-fill" id="progress"></div>
            </div>

            <div id="feedback" style="display: none;"></div>
        </div>
    </div>

    <script>
        class GermanNachbarnTrainer {
            constructor() {
                // Sentences from the provided transcript, broken into manageable chunks
                this.sentences = [
                    {
                        german: "Ich wohne seit drei Jahren in einem Mehrfamilienhaus in Berlin.",
                        phonetic: "[…™√ß ÀàvoÀên…ô za…™t d Åa…™ ÀàjaÀê Å…ôn …™n Ààa…™n…ôm ÀàmeÀê…êÃØfaÀåmiÀêli…ônÀåha äs …™n b…õ ÅÀàliÀên]",
                        vietnamese: "T√¥i s·ªëng ƒë∆∞·ª£c ba nƒÉm r·ªìi trong m·ªôt cƒÉn nh√† nhi·ªÅu gia ƒë√¨nh ·ªü Berlin.",
                        difficulty: "Mittelschwer"
                    },
                    {
                        german: "Meine Nachbarn sind ganz unterschiedlich: Manche sind freundlich und hilfsbereit.",
                        phonetic: "[Ààma…™n…ô ÀànaÀêxbaÀê…êÃØn z…™nt …°ants Àå änt…êÀà ÉiÀêtl…™√ß Ààman ß…ô z…™nt Ààf Å…î èntl…™√ß  änt Ààh…™lfsÀåb…ô Åa…™t]",
                        vietnamese: "H√†ng x√≥m c·ªßa t√¥i r·∫•t kh√°c nhau: M·ªôt s·ªë th√¨ th√¢n thi·ªán v√† hay gi√∫p ƒë·ª°.",
                        difficulty: "Schwer"
                    },
                    {
                        german: "Andere eher unh√∂flich oder sogar laut.",
                        phonetic: "[Ààand…ô Å…ô ÀàeÀê…êÃØ  änÀàh√∏Àêfl…™√ß ÀàoÀêd…ê ÀàzoÀê…°aÀê…êÃØ la ät]",
                        vietnamese: "Nh·ªØng ng∆∞·ªùi kh√°c th√¨ kh√° b·∫•t l·ªãch s·ª± ho·∫∑c th·∫≠m ch√≠ c√≤n ·ªìn √†o.",
                        difficulty: "Leicht"
                    },
                    {
                        german: "Besonders schwierig ist es mit dem jungen Paar √ºber mir.",
                        phonetic: "[b…ôÀàz…înd…ês Àà ÉviÀê Å…™√ß …™st …õs m…™t deÀêm Ààj ä≈ã…ôn paÀê…êÃØ ÀàyÀêb…ê miÀê…êÃØ]",
                        vietnamese: "ƒê·∫∑c bi·ªát kh√≥ khƒÉn l√† v·ªõi c·∫∑p ƒë√¥i tr·∫ª ·ªü t·∫ßng tr√™n t√¥i.",
                        difficulty: "Schwer"
                    },
                    {
                        german: "Sie machen oft nachts laute Musik.",
                        phonetic: "[ziÀê Ààmax…ôn …îft naxts Ààla ät…ô muÀàziÀêk]",
                        vietnamese: "H·ªç th∆∞·ªùng m·ªü nh·∫°c to v√†o ban ƒë√™m.",
                        difficulty: "Mittelschwer"
                    },
                    {
                        german: "Obwohl ich am n√§chsten Tag fr√ºh arbeiten muss.",
                        phonetic: "[…îpÀàvoÀêl …™√ß am Ààn…õÀê√ßst…ôn taÀêk f ÅyÀê Ààa Åba…™t…ôn m äs]",
                        vietnamese: "M·∫∑c d√π t√¥i ph·∫£i ƒëi l√†m s·ªõm v√†o ng√†y h√¥m sau.",
                        difficulty: "Schwer"
                    },
                    {
                        german: "Andererseits habe ich auch gute Erfahrungen gemacht.",
                        phonetic: "[Ààand…ô Å…êÀåza…™ts ÀàhaÀêb…ô …™√ß a äx Àà…°uÀêt…ô …õ…êÃØÀàfaÀê Å ä≈ã…ôn …°…ôÀàmaxt]",
                        vietnamese: "M·∫∑t kh√°c, t√¥i c≈©ng c√≥ nh·ªØng tr·∫£i nghi·ªám t·ªët.",
                        difficulty: "Schwer"
                    },
                    {
                        german: "Die √§ltere Dame nebenan hat mir in der Pandemie regelm√§√üig geholfen.",
                        phonetic: "[diÀê Àà…õlt…ô Å…ô ÀàdaÀêm…ô ÀàneÀêb…ônÀåan hat miÀê…êÃØ …™n deÀê…êÃØ pandeÀàmiÀê Àà ÅeÀê…°…ôlÀåm…õÀês…™√ß …°…ôÀàh…îlf…ôn]",
                        vietnamese: "B√† l·ªõn tu·ªïi s·ªëng c·∫°nh nh√† ƒë√£ th∆∞·ªùng xuy√™n gi√∫p ƒë·ª° t√¥i trong th·ªùi k·ª≥ ƒë·∫°i d·ªãch.",
                        difficulty: "Sehr schwer"
                    },
                    {
                        german: "Sie hat mir eingekauft, als ich krank war.",
                        phonetic: "[ziÀê hat miÀê…êÃØ Ààa…™n…°…ôÀåka äft als …™√ß k Åa≈ãk vaÀê…êÃØ]",
                        vietnamese: "B√† ·∫•y ƒë√£ mua s·∫Øm gi√∫p t√¥i khi t√¥i b·ªã ·ªëm.",
                        difficulty: "Mittelschwer"
                    },
                    {
                        german: "Wir trinken manchmal zusammen Kaffee auf dem Balkon.",
                        phonetic: "[viÀê…êÃØ Ààt Å…™≈ãk…ôn Ààman ßmaÀêl ts äÀàzam…ôn Ààkafe a äf deÀêm balÀàk…îÃÉÀê]",
                        vietnamese: "Th·ªânh tho·∫£ng ch√∫ng t√¥i u·ªëng c√† ph√™ c√πng nhau tr√™n ban c√¥ng.",
                        difficulty: "Mittelschwer"
                    },
                    {
                        german: "Und reden √ºber alles M√∂gliche.",
                        phonetic: "[ änt Àà ÅeÀêd…ôn ÀàyÀêb…ê Ààal…ôs Ààm√∏Àêkl…™ ß…ô]",
                        vietnamese: "V√† tr√≤ chuy·ªán v·ªÅ ƒë·ªß th·ª© tr√™n ƒë·ªùi.",
                        difficulty: "Leicht"
                    },
                    {
                        german: "Ich finde, Nachbarn k√∂nnen das Leben sch√∂ner machen ‚Äì aber sie k√∂nnen es auch anstrengend machen, wenn man keine R√ºcksicht nimmt.",
                        phonetic: "[…™√ß Ààf…™nd…ô ÀànaÀêxbaÀê…êÃØn Ààk≈ìn…ôn das ÀàleÀêb…ôn Àà É√∏Àên…ê max…ôn aÀêb…ê ziÀê Ààk≈ìn…ôn …õs a äx ÀàanÀå Ét Å…õ≈ã…ônt max…ôn v…õn man Ààka…™n…ô Àà Å èkz…™√ßt n…™mt]",
                        vietnamese: "T√¥i nghƒ© h√†ng x√≥m c√≥ th·ªÉ l√†m cho cu·ªôc s·ªëng ƒë·∫πp h∆°n ‚Äì nh∆∞ng h·ªç c≈©ng c√≥ th·ªÉ l√†m cho n√≥ m·ªát m·ªèi, n·∫øu kh√¥ng c√≥ s·ª± quan t√¢m l·∫´n nhau.",
                        difficulty: "Sehr schwer"
                    }
                ];

                this.currentSentence = 0;
                this.isRecording = false;
                this.mediaRecorder = null;
                this.audioChunks = [];
                this.timer = null;
                this.startTime = null;
                this.totalAccuracy = 0;
                this.completedSentences = 0;
                this.bestScore = 0;
                this.phoneticVisible = true;

                this.initializeElements();
                this.setupEventListeners();
                this.displayCurrentSentence();
                this.updateStats();
            }

            initializeElements() {
                this.elements = {
                    germanText: document.getElementById('german-text'),
                    phoneticText: document.getElementById('phonetic-text'),
                    translationText: document.getElementById('translation-text'),
                    difficultyIndicator: document.getElementById('difficulty'),
                    listenBtn: document.getElementById('listen-btn'),
                    recordBtn: document.getElementById('record-btn'),
                    stopBtn: document.getElementById('stop-btn'),
                    nextBtn: document.getElementById('next-btn'),
                    showPhoneticBtn: document.getElementById('show-phonetic-btn'),
                    repeatBtn: document.getElementById('repeat-btn'),
                    timer: document.getElementById('timer'),
                    currentSentenceNum: document.getElementById('current-sentence'),
                    feedback: document.getElementById('feedback'),
                    accuracy: document.getElementById('accuracy'),
                    bestScore: document.getElementById('best-score'),
                    progress: document.getElementById('progress')
                };
            }

            setupEventListeners() {
                this.elements.listenBtn.addEventListener('click', () => this.playAudio());
                this.elements.recordBtn.addEventListener('click', () => this.startRecording());
                this.elements.stopBtn.addEventListener('click', () => this.stopRecording());
                this.elements.nextBtn.addEventListener('click', () => this.nextSentence());
                this.elements.showPhoneticBtn.addEventListener('click', () => this.togglePhonetic());
                this.elements.repeatBtn.addEventListener('click', () => this.repeatSentence());
            }

            getDifficultyEmoji(difficulty) {
                switch(difficulty) {
                    case 'Leicht': return '‚úÖ Leicht';
                    case 'Mittelschwer': return 'üî• Mittelschwer';
                    case 'Schwer': return '‚ö° Schwer';
                    case 'Sehr schwer': return 'üíé Sehr schwer';
                    default: return 'üî• Mittelschwer';
                }
            }

            displayCurrentSentence() {
                const sentence = this.sentences[this.currentSentence];
                
                // Display German text with word spans
                const words = sentence.german.split(' ');
                this.elements.germanText.innerHTML = words.map(word => 
                    `<span class="word">${word}</span>`
                ).join(' ');

                // Display phonetic, translation and difficulty
                this.elements.phoneticText.textContent = sentence.phonetic;
                this.elements.translationText.textContent = sentence.vietnamese;
                this.elements.difficultyIndicator.textContent = this.getDifficultyEmoji(sentence.difficulty);
                
                // Update sentence number
                this.elements.currentSentenceNum.textContent = this.currentSentence + 1;
                
                // Update progress
                const progressPercent = ((this.currentSentence) / this.sentences.length) * 100;
                this.elements.progress.style.width = progressPercent + '%';

                // Reset word highlighting
                this.resetWordHighlighting();
                
                // Hide feedback
                this.elements.feedback.style.display = 'none';
                
                // Reset buttons
                this.elements.nextBtn.disabled = true;
                this.elements.recordBtn.disabled = false;
            }

            resetWordHighlighting() {
                const words = this.elements.germanText.querySelectorAll('.word');
                words.forEach(word => {
                    word.classList.remove('correct', 'incorrect');
                });
            }

            playAudio() {
                const sentence = this.sentences[this.currentSentence];
                
                if ('speechSynthesis' in window) {
                    // Stop any ongoing speech
                    speechSynthesis.cancel();
                    
                    const utterance = new SpeechSynthesisUtterance(sentence.german);
                    utterance.lang = 'de-DE';
                    utterance.rate = 0.7;
                    utterance.pitch = 1.0;
                    
                    // Try to use a German voice if available
                    const voices = speechSynthesis.getVoices();
                    const germanVoice = voices.find(voice => 
                        voice.lang.startsWith('de') || 
                        voice.name.toLowerCase().includes('deutsch') ||
                        voice.name.toLowerCase().includes('german')
                    );
                    
                    if (germanVoice) {
                        utterance.voice = germanVoice;
                    }
                    
                    speechSynthesis.speak(utterance);
                    
                    this.elements.listenBtn.disabled = true;
                    utterance.onend = () => {
                        this.elements.listenBtn.disabled = false;
                    };
                } else {
                    alert('Ihr Browser unterst√ºtzt keine Sprachausgabe.');
                }
            }

            async startRecording() {
                try {
                    const stream = await navigator.mediaDevices.getUserMedia({ 
                        audio: {
                            echoCancellation: true,
                            noiseSuppression: true,
                            autoGainControl: true
                        }
                    });
                    
                    this.mediaRecorder = new MediaRecorder(stream, {
                        mimeType: 'audio/webm;codecs=opus'
                    });
                    this.audioChunks = [];

                    this.mediaRecorder.ondataavailable = (event) => {
                        if (event.data.size > 0) {
                            this.audioChunks.push(event.data);
                        }
                    };

                    this.mediaRecorder.onstop = () => {
                        this.processRecording();
                    };

                    this.mediaRecorder.start(100); // Record in 100ms chunks
                    this.isRecording = true;
                    this.startTimer();

                    // Update UI
                    this.elements.recordBtn.disabled = true;
                    this.elements.recordBtn.classList.add('recording');
                    this.elements.stopBtn.disabled = false;
                    this.elements.listenBtn.disabled = true;

                } catch (error) {
                    console.error('Error accessing microphone:', error);
                    alert('Fehler beim Zugriff auf das Mikrofon. Bitte √ºberpr√ºfen Sie Ihre Berechtigungen.');
                }
            }

            stopRecording() {
                if (this.mediaRecorder && this.isRecording) {
                    this.mediaRecorder.stop();
                    this.mediaRecorder.stream.getTracks().forEach(track => track.stop());
                    this.isRecording = false;
                    this.stopTimer();

                    // Update UI
                    this.elements.recordBtn.disabled = false;
                    this.elements.recordBtn.classList.remove('recording');
                    this.elements.stopBtn.disabled = true;
                    this.elements.listenBtn.disabled = false;
                }
            }

            processRecording() {
                // Create audio blob for potential future use
                const audioBlob = new Blob(this.audioChunks, { type: 'audio/webm' });
                
                // Simulate pronunciation analysis based on sentence difficulty
                const sentence = this.sentences[this.currentSentence];
                const accuracy = this.simulatePronunciationAnalysis(sentence.difficulty);
                
                this.showFeedback(accuracy);
                this.highlightWords(accuracy);
                this.updateAccuracy(accuracy);
                this.elements.nextBtn.disabled = false;
            }

            simulatePronunciationAnalysis(difficulty) {
                // Simulate more realistic accuracy based on difficulty
                let baseAccuracy;
                let variation;
                
                switch(difficulty) {
                    case 'Leicht':
                        baseAccuracy = 85;
                        variation = 10;
                        break;
                    case 'Mittelschwer':
                        baseAccuracy = 78;
                        variation = 12;
                        break;
                    case 'Schwer':
                        baseAccuracy = 70;
                        variation = 15;
                        break;
                    case 'Sehr schwer':
                        baseAccuracy = 65;
                        variation = 18;
                        break;
                    default:
                        baseAccuracy = 75;
                        variation = 12;
                }
                
                const accuracy = baseAccuracy + (Math.random() - 0.5) * variation;
                return Math.max(50, Math.min(95, Math.round(accuracy)));
            }

            highlightWords(accuracy) {
                const words = this.elements.germanText.querySelectorAll('.word');
                const correctThreshold = 75;
                
                words.